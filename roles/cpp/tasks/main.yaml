- name: Include gcc tasks
  ansible.builtin.include_tasks:
    file: gcc.yaml

- name: Include llvm tasks
  ansible.builtin.include_tasks:
    file: llvm.yaml

- name: Include cmake tasks
  ansible.builtin.include_tasks:
    file: cmake.yaml

- name: Include vcpkg tasks
  ansible.builtin.include_tasks:
    file: vcpkg.yaml

- name: Install common C++ tools
  become: true
  ansible.builtin.apt:
    name:
      - bison
      - ccache
      - flex
      - gdb
      - make
      - ninja-build
      - valgrind

- name: Create symlink to {{ role_name }}.fish
  ansible.builtin.file:
    src: "{{ remote_role_path }}/files/{{ role_name }}.fish"
    dest: "{{ home }}/.config/fish/conf.d/{{ role_name }}.fish"
    state: link

- name: Set up bash
  ansible.builtin.lineinfile:
    path: "{{ home }}/.bashrc"
    regexp: 'source .*/{{ role_name }}/files'
    line: source {{ remote_role_path }}/files/bash.sh
    create: true
    mode: 0644

- name: Create symlinks to fish functions
  ansible.builtin.file:
    src: "{{ remote_role_path }}/files/fish_functions/{{ item | basename }}"
    dest: "{{ home }}/.config/fish/functions/{{ item | basename }}"
    state: link
  loop: "{{ lookup('fileglob', '{{ role_path }}/files/fish_functions/*', wantlist=True) }}"
